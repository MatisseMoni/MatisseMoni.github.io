<!DOCTYPE html>
<html>

<head>
    <title>GeoCarto</title>
    <meta charset="utf-8" />
</head>

<body>
    <h2>Exo 2</h2>
    <table>
        <thead>
            <tr>
                <th colspan="2">Avec getCurrentPosition()</th>
            </tr>
        </thead>
        <tbody id="get">
            <tr>
                <td>Latitude</td>
                <td class="latitude"></td>
            </tr>
            <tr>
                <td>Longitude</td>
                <td class="longitude"></td>
            </tr>
            <tr>
                <td>Précision</td>
                <td class="precision"></td>
            </tr>
            <tr>
                <td>Vitesse</td>
                <td class="vitesse"></td>
            </tr>
            <tr>
                <td>Timestamp</td>
                <td class="time"></td>
            </tr>
        </tbody>
        <thead>
            <tr>
                <th colspan="2">Avec watchPosition()</th>
            </tr>
        </thead>
        <tbody id="watch">
            <tr>
                <td>Latitude</td>
                <td class="latitude"></td>
            </tr>
            <tr>
                <td>Longitude</td>
                <td class="longitude"></td>
            </tr>
            <tr>
                <td>Précision</td>
                <td class="precision"></td>
            </tr>
            <tr>
                <td>Vitesse</td>
                <td class="vitesse"></td>
            </tr>
            <tr>
                <td>Timestamp</td>
                <td class="time"></td>
            </tr>
        </tbody>
        <thead>
            <tr>
                <th colspan="2">Exo 3</th>
            </tr>
        </thead>
        <tbody id="orientation">
            <tr>
                <td>X</td>
                <td id="x"></td>
            </tr>
            <tr>
                <td>Y</td>
                <td id="y"></td>
            </tr>
            <tr>
                <td>Z</td>
                <td id="z"></td>
            </tr>
        </tbody>
    </table>
</body>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
<script>
    function getPosition() {
        var options = {
            enableHighAccuracy: true,
            timeout: 5000,
            maximumAge: 0
        };

        function success(pos) {
            var crd = pos.coords;
            var time = pos.timestamp
            jQuery("#get .latitude").text(crd.latitude)
            jQuery("#get .longitude").text(crd.longitude)
            jQuery("#get .precision").text(crd.accuracy)
            jQuery("#get .time").text(time)
            jQuery("#get .vitesse").text(crd.speed)
        }

        function error(err) {
            console.warn(`ERREUR (${err.code}): ${err.message}`);
        }

        navigator.geolocation.getCurrentPosition(success, error, options);
    }

    function watch() {
        var id, target, options;

        function success(pos) {
            var crd = pos.coords;
            var time = pos.timestamp
            jQuery("#watch .latitude").text(crd.latitude)
            jQuery("#watch .longitude").text(crd.longitude)
            jQuery("#watch .precision").text(crd.accuracy)
            jQuery("#watch .time").text(time)
            jQuery("#watch .vitesse").text(crd.speed)
        }

        function error(err) {
            console.warn('ERROR(' + err.code + '): ' + err.message);
        }

        options = {
            enableHighAccuracy: false,
            timeout: 5000,
            maximumAge: 0
        };

        id = navigator.geolocation.watchPosition(success, error, options);
    }

    watch()
    getPosition()

    if (window.DeviceOrientationEvent) {
        window.addEventListener('deviceorientation', function (event) {
            $("#x").text(event.alpha.toFixed(2))
            $("#y").text(event.beta.toFixed(2))
            $("#z").text(event.gamma.toFixed(2))
        });
    }


</script>

</html>